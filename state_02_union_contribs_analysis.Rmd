---
title: "State-Level Police Union Contributions"
author: "Aaron Kessler"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(htmltools)
library(widgetframe)
library(scales)
library(zoo)
library(lubridate)
library(kableExtra)
library(writexl)
options(scipen = 999)

#load the data tables from step 01
contribs_tocands <- readRDS("processed_data/contribs_tocands.rds")
contribs_topartycmtes <- readRDS("processed_data/contribs_topartycmtes.rds")
contribs_combined_candspartycmtes <- readRDS("processed_data/contribs_combined_candspartycmtes.rds")
currentofficeholders_byparty <- readRDS("processed_data/currentofficeholders_byparty.rds")
statepops <- readRDS("processed_data/statepops.rds")
grandtotals_alldonors_tocandidates <- readRDS("processed_data/grandtotals_alldonors_tocandidates.rds")


contribs_tocands %>% 
  group_by(general_party) %>% 
  summarise(sum(dollar_amount)) 

contribs_topartycmtes %>% 
  group_by(party) %>% 
  summarise(sum(dollar_amount)) 

contribs_tocands %>% 
  group_by(incumbency_status) %>% 
  summarise(tot_dollars = sum(dollar_amount)) %>% 
  mutate(tot_dollars / sum(tot_dollars) * 100)

#just MN records for JD
contribs_combined_candspartycmtes %>% 
  filter(election_jurisdiction == "MN") %>% 
  write_xlsx("output/MNonly_contribs_combined.xlsx")


#if want to limit the years choose here, then uncomment filters below
timeframe_vector <- c("2014", "2016", "2017", "2018", "2019", "2020")


#create per capita measures and rankings #### ----------------------------
staterankings_tocands_all <- contribs_tocands %>% 
  # filter(election_year %in% timeframe_vector) %>% #filtering years here
  group_by(election_jurisdiction) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  arrange(desc(total_dollars)) %>% 
  inner_join(statepops, by = c("election_jurisdiction" = "state")) %>% 
  mutate(
    dollars_per1000ppl = (total_dollars / population) * 1000,
    rank_dollars_per1000ppl = min_rank(desc(dollars_per1000ppl)),
    rank_population = min_rank(desc(population))
  ) %>% 
  arrange(rank_dollars_per1000ppl)

staterankings_tocands_all %>% write_xlsx("output/staterankings_tocands_all.xlsx")


staterankings_topartycmtes_all <- contribs_topartycmtes %>% 
  # filter(election_year %in% timeframe_vector) %>% #filtering years here
  group_by(election_jurisdiction) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  arrange(desc(total_dollars)) %>% 
  inner_join(statepops, by = c("election_jurisdiction" = "state")) %>% 
  mutate(
    dollars_per1000ppl = (total_dollars / population) * 1000,
    rank_dollars_per1000ppl = min_rank(desc(dollars_per1000ppl)),
    rank_population = min_rank(desc(population))
  ) %>% 
  arrange(rank_dollars_per1000ppl)

staterankings_topartycmtes_all %>% write_xlsx("output/staterankings_topartycmtes_all.xlsx")


staterankings_tocombinedcandsparties <- contribs_combined_candspartycmtes %>% 
  # filter(election_year %in% timeframe_vector) %>% #filtering years here
  group_by(election_jurisdiction) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  arrange(desc(total_dollars)) %>% 
  inner_join(statepops, by = c("election_jurisdiction" = "state")) %>% 
  mutate(
    dollars_per1000ppl = (total_dollars / population) * 1000,
    rank_dollars_per1000ppl = min_rank(desc(dollars_per1000ppl)),
    rank_population = min_rank(desc(population))
  ) %>% 
  arrange(rank_dollars_per1000ppl)

staterankings_tocombinedcandsparties %>% write_xlsx("output/staterankings_tocombinedcandsparties.xlsx")

contribs_tocands %>% 
  count(election_year)


### df of contribs by year, party #### -------------------------------------------------
partytotal_by_year <- contribs_combined_candspartycmtes %>% 
  filter(party %in% c("Democratic", "Republican")) %>% 
  group_by(election_year, party) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  ungroup() %>% 
  mutate(
    election_year = as_factor(election_year)
  )

### df of contribs by year, party - NO CALIFORNIA
partytotal_by_year_NOCALIF <- contribs_combined_candspartycmtes %>% 
  filter(party %in% c("Democratic", "Republican"),
         election_jurisdiction != "CA") %>% 
  group_by(election_year, party) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  ungroup() %>% 
  mutate(
    election_year = as_factor(election_year)
  )
  


## GRAND TOTALS / percentages of total candidate contribs #### -------------------------
glimpse(grandtotals_alldonors_tocandidates)

grandtotals_alldonors_tocandidates %>% 
  count(election_year)

# grant total by party
grandtotals_alldonors_tocandidates %>% 
  filter(general_party %in% c("Democratic", "Republican")) %>% 
  group_by(general_party) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  ungroup()


# grand total by state
statetotals_ALLcontribs <- grandtotals_alldonors_tocandidates %>% 
  filter(general_party %in% c("Democratic", "Republican")) %>% 
  # filter(election_year %in% timeframe_vector) %>% #filtering years here
  group_by(election_jurisdiction) %>% 
  summarise(total_dollars_allcontribs = sum(dollar_amount)) %>% 
  ungroup()

# total by state for police contribs
statetotals_policecontribs <- contribs_tocands %>% 
  filter(general_party %in% c("Democratic", "Republican")) %>% 
  # filter(election_year %in% timeframe_vector) %>% #filtering years here
  group_by(election_jurisdiction) %>% 
  summarise(total_dollars_policecontribs = sum(dollar_amount)) %>% 
  ungroup()

#join together in order to calculate percentages
statetotals_pct <- inner_join(statetotals_ALLcontribs, statetotals_policecontribs, 
           by = "election_jurisdiction")

#add calculated columns
statetotals_pct <- statetotals_pct %>% 
  mutate(
    pct_police_ofevery100K = (total_dollars_policecontribs / total_dollars_allcontribs) * 100000,
    pct_police_rank = min_rank(desc(pct_police_ofevery100K))
  ) %>% 
  arrange(pct_police_rank)


statetotals_pct

###to find-- contributions by state; contributions by state and party
contribs_combined_candspartycmtes %>% 
  filter(party %in% c("Democratic", "Republican")) %>% 
  group_by(election_jurisdiction) %>% 
  summarise(total_contribs = sum(dollar_amount)) %>% 
  arrange(desc(total_contribs)) %>% 
  write_xlsx("output/totaldemgop_bystate.xlsx")

contribs_combined_candspartycmtes %>% 
  filter(party %in% c("Democratic", "Republican")) %>% 
  group_by(election_jurisdiction, party) %>% 
  summarise(total_contribs = sum(dollar_amount)) %>% 
  arrange(election_jurisdiction, party) %>% 
  write_xlsx("output/totaldemgop_bystate_byparty.xlsx")


```


```{r narrative_vals, include=FALSE}
###this chunk used for working out R code for inserting pieces in-line into narrative below


#grand total
vector_total_all_topline <- contribs_combined_candspartycmtes %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  mutate(total_dollars = dollar(total_dollars)) %>% 
  pull()


#total to Democratic cands/cmtes
vector_total_dem_candscmtes <- contribs_combined_candspartycmtes %>% 
  filter(party == "Democratic") %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  mutate(total_dollars = dollar(total_dollars)) %>% 
  pull()

#total to Republican cands/cmtes
vector_total_gop_candscmtes <- contribs_combined_candspartycmtes %>% 
  filter(party == "Republican") %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  mutate(total_dollars = dollar(total_dollars)) %>% 
  pull()

#total to CURRENT Democratic cands/cmtes
vector_total_dem_CURRENTcandscmtes <- currentofficeholders_byparty %>% 
  filter(general_party == "Democratic") %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  mutate(total_dollars = dollar(total_dollars)) %>% 
  pull()

#total to CURRENT Republican cands/cmtes
vector_total_gop_CURRENTcandscmtes <- currentofficeholders_byparty %>% 
  filter(general_party == "Republican") %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  mutate(total_dollars = dollar(total_dollars)) %>% 
  pull()


incumb_summary <- contribs_tocands %>% 
  group_by(incumbency_status) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  mutate(pct = round_half_up(total_dollars / sum(total_dollars) * 100))

vector_incumbentpct <- incumb_summary %>% filter(incumbency_status == "Incumbent") %>% pull(pct)
vector_challengerpct <- incumb_summary %>% filter(incumbency_status == "Challenger") %>% pull(pct)
vector_openseatpct <- incumb_summary %>% filter(incumbency_status == "Open") %>% pull(pct)


```

## Lede/Summary

It's been a long time coming, but recent weeks have finally brought about a sea change in public opinion toward police in the wake of George Floyd's death in Minneapolis. Police abuses of power and the targeting, and killing, of black Americans, has sent thousands of people into the streets to protest across the country on a scale not seen in decades. And surveys now show broad support nationwide for reforms to hold police accountable.

But whether this moment translates into the political will strong enough to overcome police departments' repeated ability to thrwart efforts to change the system remains to be seen. The real test will be in the states themselves, where the police and their powerful unions are major players, having spent tens of millions of dollars to curry favor with state and local politicians. 

In fact, police-affiliated unions and associations have contributed **`r vector_total_all_topline`** to state candidates and political parties across the United States since the 2000 election, a new Bloomberg Industry Group analysis found.

The majority of that money has gone to Democrats, who in some places have responded by blocking meaningful change to end excessive use of force, even after horrific incidents. Minnesota's inaction after the 2016 death of Philando Castile could be exhibit A. Baltimore, where Freddie Gray died in police custody in 2015 as a result of a catastrophic neck injury, similarly failed to subsequently take meaningful action.

Democratic candidates and party committees recieved **`r vector_total_dem_candscmtes`** compared with Republicans' **`r vector_total_gop_candscmtes`** over the last two decades, according to the analysis of campaign data compiled by the nonprofit National Institute on Money in Politics.

And the Democratic state politicians holding office right now at this very moment? They've collectively received about **`r vector_total_dem_CURRENTcandscmtes`** from law enforcement unions over the course of their careers -- nearly triple the **`r vector_total_gop_CURRENTcandscmtes`** of their current Republican counterparts. 

To be sure, the analysis shows police groups favored the candidates with power - those who are already *incumbents* - more so than a particular party. An overwhelming **`r vector_incumbentpct` percent** of police group money to candidates went to incumbents over the last two decades. Another  **`r vector_openseatpct` percent** of the money went to contenders for open seats, where there was no current officeholder to run against.  
Only  **`r vector_challengerpct` percent** of contributions by police groups went to candidates challenging an incumbent.

That said, it doesn't take the pressure off Democrats, who are in a bind that they TKTKTKTKTK.... It's likely that TKTKTKTK....
    


## Where the money dominates

If we look at **state-by-state giving accounting for population**, we find something interesting.  

First, it turns out **California** and **New York** still top the list even after adjusting for their populations.  
  
But perhaps more strikingly are the smaller states that have a *substantially larger* amount of police union contributions. **Rhode Island**, **Arkansas**, and **Delaware** rank *at the bottom by population*, yet they're among the *highest ranked for per-capita police contributions*.  
  
**New Jersey** and **Washington State**, both with well-known problems with their police departments' use of force, also have notably *outsized campaign contributions* as well given their populations.

```{r, echo=FALSE}
staterankings_tocombinedcandsparties %>% 
  head(10) %>% 
  mutate(
    total_dollars = scales::dollar(total_dollars),
    dollars_per1000ppl = scales::dollar(dollars_per1000ppl)
) %>% 
  kable(format.args = list(big.mark = ",")) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>% 
  column_spec(6, bold = T, color = "purple") %>% 
  column_spec(5, bold = T, color = "red") %>% 
  column_spec(1, bold = T, color = "black") 


```

#### Here are the rankings for **just candidates alone**...

```{r, echo=FALSE}

staterankings_tocands_all %>% 
  head(10) %>% 
  mutate(
    total_dollars = scales::dollar(total_dollars),
    dollars_per1000ppl = scales::dollar(dollars_per1000ppl)
) %>% 
  kable(format.args = list(big.mark = ",")) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>% 
  column_spec(6, bold = T, color = "purple") %>% 
  column_spec(5, bold = T, color = "red") %>% 
  column_spec(1, bold = T, color = "black") 


```


### Percent of total contributions that are police group money
This table ranks states by the percentage of total money contributed by **all donors** to candidates that **comes from police groups**. What share of the grand total of all political money to state candidates is made of up police groups -- expressed per 100K (*"e.g. $150 out of every $100,000 contributed"*)

```{r, echo=FALSE}

statetotals_pct %>% 
  select(election_jurisdiction, pct_police_rank, pct_police_ofevery100K, total_dollars_policecontribs) %>%
  head(25) %>% 
  mutate(
    pct_police_ofevery100K = round_half_up(pct_police_ofevery100K),
    pct_police_ofevery100K = scales::dollar(pct_police_ofevery100K),
    total_dollars_policecontribs = round_half_up(total_dollars_policecontribs),
    total_dollars_policecontribs = scales::dollar(total_dollars_policecontribs)
  ) %>% 
  kable(format.args = list(big.mark = ",")) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left") %>% 
  column_spec(2, bold = T) 

```
  
  
  
  
  
## Party Contributions by Election Year/Cycle

Here are what things look like by election cycle going to each party. Note that only a few states have "off-year" elections (on the odd years) which is why those years are always so much lower.  

```{r, echo=FALSE}

# Set palette:
cbPalette <- c("#4097F1","#EC5F4F")

d <- ggplot(data = partytotal_by_year, aes(x = election_year, y = total_dollars, fill = party)) +
  geom_col(position = "dodge") + theme_minimal() + 
  labs(title="Police union contributions to state candidates and parties",
               subtitle = "(2000-2020 election cycles)",
               caption = "",
               x ="", y = "") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  scale_fill_manual(values=cbPalette) +
  theme(legend.title=element_blank())

d + theme(axis.text.x  = element_text(angle=90, vjust=0.5, size = 8)) +
  scale_y_continuous(labels=dollar_format())



```

Because **California** has an enormous amount of police group contributions, that state alone makes the Democrats especially dominant in what they receive. The chart below shows the totals **without California** included, which reveals a more nuanced picture of police group activty elsewhere, where the two parties were generally much closer during many cycles. Democrats still loomed much larger in the 2010 and 2014 election years, though things became more neck-and-neck after that.
  
One potential trend that may be worth exploring is the way these contributions at the state level **mirror in some ways the presidential incumbent** at the time? In that Republican state party candidates and committees generally received a bit more after 9/11 during the W. Bush years, then after Obama was elected there's a huge surge in Dem money and advantage, then with 2016 and the ascendence of Trump, the Democratic advantage all but disappears and the parties are much closer again in recent cycles.


```{r, echo=FALSE}

d2 <- ggplot(data = partytotal_by_year_NOCALIF, aes(x = election_year, y = total_dollars, fill = party)) +
  geom_col(position = "dodge") + theme_minimal() + 
  labs(title="Police union contributions to state candidates and parties",
               subtitle = "(Excluding California, 2000-2020 election cycles)",
               caption = "",
               x ="", y = "") +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  scale_fill_manual(values=cbPalette) +
  theme(legend.title=element_blank())

d2 + theme(axis.text.x  = element_text(angle=90, vjust=0.5, size = 8)) +
  scale_y_continuous(labels=dollar_format())


```


## Top candidates

Who are the candidates who have gotten the biggest bails of cash from police unions and associations over the years? They include both the current Democratic governors of New York, **Andrew Cuomo**, and California, **Gavin Newsom**.

```{r, echo=FALSE}

#clean up Andrew Cuomo records to standardize his listings since they are recorded three ways
contribs_tocands <- contribs_tocands %>% 
  mutate(
    candidate = if_else(candidate == "CUOMO, ANDREW M & DUFFY, ROBERT J", "CUOMO, ANDREW M", candidate),
    candidate = if_else(candidate == "CUOMO, ANDREW M & HOCHUL, KATHLEEN COURTNEY (KATHY)", "CUOMO, ANDREW M", candidate)
  )

topcands_dem <- contribs_tocands %>% 
  filter(general_party == "Democratic") %>% 
  group_by(candidate, election_jurisdiction) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  arrange(desc(total_dollars)) %>% 
  head(10)

vector_cuomo <- topcands_dem %>% 
  filter(candidate == "CUOMO, ANDREW M") %>% 
  mutate(total_dollars = dollar(total_dollars)) %>% 
  pull(total_dollars)

vector_denapoli <- topcands_dem %>% 
  filter(candidate == "DINAPOLI, THOMAS P") %>% 
  mutate(total_dollars = dollar(total_dollars)) %>% 
  pull(total_dollars)

vector_newsom <- topcands_dem %>% 
  filter(candidate == "NEWSOM, GAVIN") %>% 
  mutate(total_dollars = dollar(total_dollars)) %>% 
  pull(total_dollars)

#display table for top dems
topcands_dem %>% 
  kable(format.args = list(big.mark = ",")) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")


```

**Cuomo** tops the list of any currently elected state official for contributions from police groups - he's received a total of **`r vector_cuomo`** (though the arcane nature of New York campaign finance rules means some of that money was given to a joint account he shared with running mates). The longtime state comptroller of New York, **Thomas DiNapoli**, is not far behind with **`r vector_denapoli`**. California's **Newsom** has taken **`r vector_newsom`**.

(The champion overall, former California governor Gray Davis, hasn't been in office since the early 2000s; he was sent packing after an anti-establishment upheaval resulted in a 2003 recall election that scrambled California politics.)  
  
And here are the **top Republican candidates**, all but one of them New York politicans...


```{r, echo=FALSE}

topcands_gop <- contribs_tocands %>% 
  filter(general_party == "Republican") %>% 
  group_by(candidate, election_jurisdiction) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  arrange(desc(total_dollars)) %>% 
  head(10)

topcands_gop %>% 
  kable(format.args = list(big.mark = ",")) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")


```
  

  
## Top Donors

The **top police unions and associations** since 2000 in total giving to both parties is perhaps not surprisingly concentrated among groups in California and New York...perhaps not surprising. The states here at the top are huge.

```{r, echo=FALSE, warning=FALSE}
topdonors <- contribs_combined_candspartycmtes %>% 
  group_by(contributor) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  arrange(desc(total_dollars)) %>% 
  head(10)

topdonors %>% 
  kable(format.args = list(big.mark = ",")) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")



```

The top donor, the *Peace Officers Research Assn of California*, does indeed give to a variety of candidates and is a big-dollar donor to the CA Democratic Party. Not just ballot initatives as had been suspected.

```{r, echo=FALSE, warning=FALSE}
contribs_combined_candspartycmtes %>% 
  filter(contributor == "PEACE OFFICERS RESEARCH ASSOCIATION OF CALIFORNIA") %>% 
  group_by(recipient, recipient_type, party) %>% 
  summarise(total_dollars = sum(dollar_amount)) %>% 
  arrange(desc(total_dollars)) %>% 
  head(10) %>% 
  kable(format.args = list(big.mark = ",")) %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "left")



```










```{r, echo=FALSE}




```



```{r, echo=FALSE}




```



```{r, echo=FALSE}




```



```{r, echo=FALSE}




```


```{r, echo=FALSE}




```

